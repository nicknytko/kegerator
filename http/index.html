<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Kegerator</title>
        <style>
         body
         {
             font-family: sans-serif;
         }
         #units
         {
             text-align: center;
             font-size: 35px;
             padding-top: 50px;
         }
         canvas
         {
             display: block;
             margin: auto;
             padding-top: 100px;
         }
        </style>
        <script>        
         const pint_glass_ml = 473;
         const ml_per_pulse = 0.638359;
         
         const glass_bottom_width = 160;
         const glass_top_width = 220;
         const glass_height = 380;
         const glass_color = "#ccccccff";
         const glass_outline_color = "#aaaaaaee";
         const beer_bottom_color = "#e59f49ff";
         const beer_top_color = "#f94b16ff";

         var context = null;
         var canvas_width = 0;
         var canvas_height = 0;

         var current_volume = 0;
         var target_volume = 0;
         
         function update_labels( pulses )
         {
             var volume = pulses * ml_per_pulse;
             
             document.getElementById( "pulses" ).innerText = pulses.toString( );
             document.getElementById( "milliliters" ).innerText = volume.toFixed( 2 );

             draw_glass( volume );
         }

         function draw_glass( volume )
         {
             if ( volume > pint_glass_ml )
                 {
                     volume = pint_glass_ml;
                 }
             
             var beer_top_width = glass_bottom_width +
                 ( ( volume / pint_glass_ml ) * ( glass_top_width - glass_bottom_width ) );
             var area = ( volume / pint_glass_ml ) *
                 ( ( glass_bottom_width + glass_top_width ) * glass_height / 2 );
             var beer_height = ( 2 * area ) / ( glass_bottom_width + beer_top_width );

             context.fillStyle = glass_color;
             context.strokeStyle = glass_outline_color;
             context.lineWidth = 3;
             
             context.beginPath( );
             context.moveTo( canvas_width/2 - glass_top_width/2, 0 );
             context.lineTo( canvas_width/2 + glass_top_width/2, 0 );
             context.lineTo( canvas_width/2 + glass_bottom_width/2, glass_height );
             context.lineTo( canvas_width/2 - glass_bottom_width/2, glass_height );
             context.closePath( );
             context.fill( );
             context.stroke( );

             var beer_gradient = context.createLinearGradient( 0, 0, 0, glass_height );
             beer_gradient.addColorStop( 0, beer_top_color );
             beer_gradient.addColorStop( 1, beer_bottom_color );
             context.fillStyle = beer_gradient;
             
             context.beginPath( );
             context.moveTo( canvas_width/2 - beer_top_width/2, glass_height - beer_height );
             context.lineTo( canvas_width/2 + beer_top_width/2, glass_height - beer_height );
             context.lineTo( canvas_width/2 + glass_bottom_width/2, glass_height );
             context.lineTo( canvas_width/2 - glass_bottom_width/2, glass_height );
             context.closePath( );
             context.fill( );
         }

         window.onload = function( )
         {
             var canvas = document.getElementById( "glass" );
             context = canvas.getContext( "2d" );
             canvas_width = canvas.width;
             canvas_height = canvas.height;
         
             update_labels( 0 );
         }
        </script>
    </head>
    <body>
        <div id="units">
            <span id="pulses">0</span> pulses &asymp;
            <span id="milliliters">0</span> mL
        </div>
        <canvas id="glass" width="400" height="400">
            
        </canvas>
    </body>
</html>
